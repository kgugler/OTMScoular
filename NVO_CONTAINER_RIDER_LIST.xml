<?xml version="1.0" encoding="utf-8"?>
<dataTemplate name="NVO_CONTAINER_RIDER_LIST" description="NVO Container Rider List" dataSourceRef="ORCL" defaultPackage="" version="1.0">
  <parameters>
    <parameter name="JOB_ID" dataType="character" />
    <parameter name="PRINT_NT_WT" dataType="character" />
    <parameter name="PRINT_VOL" dataType="character" />
    <parameter name="P_RUN" dataType="character"></parameter>
    <parameter name="P_REPORT_GID" dataType="character" />
    <parameter name="P_DISPLAY_NAME" dataType="character" />
    <parameter name="P_DOMAIN" dataType="character" />
    <parameter name="P_GL_USER" dataType="character"></parameter>
  </parameters>
  <lexicals></lexicals>
  <dataQuery>
    <sqlStatement name="Q_DRAFT_FINAL"><![CDATA[SELECT :P_RUN draft_final, :PRINT_NT_WT nt_wt_y_n, :PRINT_VOL vol_y_n FROM DUAL]]></sqlStatement>
    <sqlStatement name="Q_MAIN"><![CDATA[SELECT DISTINCT ('TSC' || j.job_xid) bl_num 
FROM job j
WHERE j.job_gid = :JOB_ID]]></sqlStatement>
    <sqlStatement name="Q_ROWS"><![CDATA[SELECT DISTINCT
  a.s_ship_unit_gid,
	(CASE WHEN :P_RUN = 'DRAFT' THEN NVL(a.tag_3, 'Data Missing in System') ELSE a.tag_3 END) container_number,
	(CASE WHEN :P_RUN = 'DRAFT' THEN
    (CASE WHEN NVL(TRIM(a.tag_1 || ' ' || a.seal_2 || ' ' || a.seal_3),'XXYYZZYYXX') = 'XXYYZZYYXX' THEN
      'Data Missing in System'
    ELSE
      TRIM(
      (CASE WHEN a.attribute1 = 'YES' THEN
        'AGENT SEAL '
      ELSE
        ''
      END) ||         
      a.tag_1 || ' ' ||
      (CASE WHEN a.attribute1 = 'YES' THEN
        'CUSTOMS SEAL '
      ELSE
        ''
      END) ||        
      a.seal_2 || ' ' || a.seal_3)
    END)
  ELSE
    TRIM(
    (CASE WHEN a.attribute1 = 'YES' THEN
      'AGENT SEAL '
    ELSE
      ''
    END) ||       
    a.tag_1 || ' ' ||
    (CASE WHEN a.attribute1 = 'YES' THEN
      'CUSTOMS SEAL '
    ELSE
      ''
    END) ||      
    a.seal_2 || ' ' || a.seal_3)
  END) ||
  (CASE WHEN :P_RUN = 'DRAFT' THEN
    ' ' || NVL(a.marks_numbers,'Data Missing in System')
  ELSE
    (CASE WHEN NOT a.marks_numbers IS NULL THEN
      ' ' || a.marks_numbers 
    END)
  END)
  seal_num,  
	REPLACE((CASE WHEN :P_RUN = 'DRAFT' THEN 
    NVL((CASE WHEN a.descrip1 IS NULL THEN a.descrip2
    ELSE a.descrip1 END), 'Data Missing in System')
	ELSE 
    (CASE WHEN a.descrip1 IS NULL THEN a.descrip2
    ELSE a.descrip1 END) 
  END),'|',CHR(13)) description,  
	(CASE WHEN :P_RUN = 'DRAFT' THEN NVL(TRIM(TO_CHAR(a.num_b, '999,999,990')), 'Data Missing in System')
	ELSE TRIM(TO_CHAR(a.num_b, '999,999,990')) END) number_bags,
	(CASE WHEN :P_RUN = 'DRAFT' THEN NVL(
    (CASE WHEN a.num_b > 1 THEN
      (SELECT pt.plural_text
      FROM glogowner.xxscou_piece_type pt
      WHERE pt.code = a.typ)
    ELSE
      (SELECT pt.singular_text
      FROM glogowner.xxscou_piece_type pt
      WHERE pt.code = a.typ)
    END), 'Data Missing in System')
	ELSE 
    (CASE WHEN a.num_b > 1 THEN
      (SELECT pt.plural_text
      FROM glogowner.xxscou_piece_type pt
      WHERE pt.code = a.typ)
    ELSE
      (SELECT pt.singular_text
      FROM glogowner.xxscou_piece_type pt
      WHERE pt.code = a.typ)
    END)  
  END) pc_type,  
  (CASE WHEN :P_RUN = 'DRAFT' THEN NVL(TRIM(TO_CHAR(a.received_weight, '999,999,990.000')), 'Data Missing in System')
	ELSE TRIM(TO_CHAR(a.received_weight, '999,999,990.000')) END) || ' ' ||
  (CASE WHEN :P_RUN = 'DRAFT' THEN NVL(a.received_weight_uom, 'Data Missing in System')
	ELSE a.received_weight_uom END)  
  unit_weight,
  (CASE WHEN :PRINT_NT_WT = 'YES' THEN
  (CASE WHEN :P_RUN = 'DRAFT' THEN NVL(TRIM(TO_CHAR(a.unit_net_weight, '999,999,990.000')), 'Data Missing in System')
	ELSE TRIM(TO_CHAR(a.unit_net_weight, '999,999,990.000')) END) || ' ' ||
  (CASE WHEN :P_RUN = 'DRAFT' THEN NVL(a.unit_net_weight_uom_code, 'Data Missing in System')
	ELSE a.unit_net_weight_uom_code END)
  ELSE '' END)
  net_weight,
  (CASE WHEN :PRINT_VOL = 'YES' THEN
  (CASE WHEN :P_RUN = 'DRAFT' THEN NVL(a.vol, 'Data Missing in System')
	ELSE a.vol END) || ' ' ||
  (CASE WHEN :P_RUN = 'DRAFT' THEN NVL(a.vol_uom, 'Data Missing in System')
	ELSE a.vol_uom END)
  ELSE '' END)
  gross_volume
FROM
(SELECT
  ssu.s_ship_unit_gid,
  ssu.tag_3,
  ssu.tag_1,
  (SELECT ssur.refnum_value
  FROM s_ship_unit_refnum ssur 
  WHERE ssur.s_ship_unit_gid = ssu.s_ship_unit_gid
  AND ssur.s_ship_unit_refnum_qual_gid = 'SCOULAR.CONTAINER SEAL NUMBER 2') seal_2,
  (SELECT ssur.refnum_value
  FROM s_ship_unit_refnum ssur 
  WHERE ssur.s_ship_unit_gid = ssu.s_ship_unit_gid
  AND ssur.s_ship_unit_refnum_qual_gid = 'SCOULAR.CONTAINER SEAL NUMBER 3') seal_3,
  (SELECT ssur.refnum_value
  FROM s_ship_unit_refnum ssur 
  WHERE ssur.s_ship_unit_gid = ssu.s_ship_unit_gid
  AND ssur.s_ship_unit_refnum_qual_gid = 'SCOULAR.MARKS AND NUMBERS') marks_numbers,
  s.attribute1,
  ssurem1.remark_text descrip1,
  srem1.remark_text descrip2,
  TRIM(ssur1.refnum_value) num_b,
  TRIM(ssur2.refnum_value) typ,
  TRIM(ssur3.refnum_value) vol,
  TRIM(ssur4.refnum_value) vol_uom,
  ssu.received_weight,
  ssu.received_weight_uom,
  ssu.unit_net_weight,
  ssu.unit_net_weight_uom_code
FROM
	job j
LEFT OUTER JOIN
  job_order_release_join jorj ON j.job_gid = jorj.job_gid
LEFT OUTER JOIN 
  s_ship_unit_line ssul ON jorj.order_release_gid = ssul.order_release_gid
LEFT OUTER JOIN 
  s_equipment_s_ship_unit_join sessuj ON sessuj.s_ship_unit_gid = ssul.s_ship_unit_gid
LEFT OUTER JOIN 
  shipment_s_equipment_join ssej ON sessuj.s_equipment_gid = ssej.s_equipment_gid
LEFT OUTER JOIN
  shipment s ON ssej.shipment_gid = s.shipment_gid
AND
	s.shipment_type_gid = 'TRANSPORT'
AND 
  s.transport_mode_gid = 'VESSEL-CO'
AND
	s.is_primary = 'Y'
AND
  s.perspective = 'B'
JOIN
	shipment_stop_d sstopd ON s.shipment_gid = sstopd.shipment_gid
AND
	sstopd.stop_num = 1
LEFT OUTER JOIN
	shipment_remark srem1 ON s.shipment_gid = srem1.shipment_gid
AND
	srem1.remark_qual_gid = 'SCOULAR/NVO.HBL DESCRIPTION OF CARGO'    
LEFT OUTER JOIN
	s_ship_unit ssu ON sstopd.s_ship_unit_gid = ssu.s_ship_unit_gid  
LEFT OUTER JOIN
	s_ship_unit_remark ssurem1 ON ssu.s_ship_unit_gid = ssurem1.s_ship_unit_gid
AND
	ssurem1.remark_qual_gid = 'SCOULAR/NVO.DESCRIPTION OF CARGO OVERRIDE'  
LEFT OUTER JOIN
	s_ship_unit_refnum ssur1 ON ssu.s_ship_unit_gid = ssur1.s_ship_unit_gid
AND
	ssur1.s_ship_unit_refnum_qual_gid = 'SCOULAR.PIECE COUNT'
LEFT OUTER JOIN
	s_ship_unit_refnum ssur2 ON ssu.s_ship_unit_gid = ssur2.s_ship_unit_gid
AND
	ssur2.s_ship_unit_refnum_qual_gid = 'SCOULAR.PIECE TYPE'  
LEFT OUTER JOIN
	s_ship_unit_refnum ssur3 ON ssu.s_ship_unit_gid = ssur3.s_ship_unit_gid
AND
	ssur3.s_ship_unit_refnum_qual_gid = 'SCOULAR/NVO.CONTAINER_GROSS_VOLUME'
LEFT OUTER JOIN
	s_ship_unit_refnum ssur4 ON ssu.s_ship_unit_gid = ssur4.s_ship_unit_gid
AND
	ssur4.s_ship_unit_refnum_qual_gid = 'SCOULAR/NVO.CONTAINER_GROSS_VOLUME_UOM'      
WHERE
	j.job_gid = :JOB_ID
AND NOT
  s.shipment_gid IS NULL) a
ORDER BY a.s_ship_unit_gid]]></sqlStatement>
  </dataQuery>
  <dataStructure>
    <group name="G_DRAFT_FINAL" source="Q_DRAFT_FINAL">
      <element name="DRAFT_FINAL" value="DRAFT_FINAL" />
      <element name="NT_WT_Y_N" value="NT_WT_Y_N" />
      <element name="VOL_Y_N" value="VOL_Y_N" />
    </group>
    <group name="G_MAIN" source="Q_MAIN">
      <element name="BL_NUM" value="BL_NUM" />
    </group>
    <group name="G_ROWS" source="Q_ROWS">
      <element name="CONTAINER_NUMBER" value="CONTAINER_NUMBER" />
      <element name="SEAL_NUM" value="SEAL_NUM" />
      <element name="DESCRIPTION" value="DESCRIPTION" />
      <element name="NUMBER_BAGS" value="NUMBER_BAGS"></element>
      <element name="PC_TYPE" value="PC_TYPE"></element>
      <element name="UNIT_WEIGHT" value="UNIT_WEIGHT" />
      <element name="NET_WEIGHT" value="NET_WEIGHT" />
      <element name="GROSS_VOLUME" value="GROSS_VOLUME" />
    </group>
  </dataStructure>
</dataTemplate>